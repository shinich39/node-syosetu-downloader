"use strict";var ut=Object.create;var O=Object.defineProperty;var ct=Object.getOwnPropertyDescriptor;var ft=Object.getOwnPropertyNames;var ht=Object.getPrototypeOf,pt=Object.prototype.hasOwnProperty;var gt=(r,t)=>{for(var e in t)O(r,e,{get:t[e],enumerable:!0})},L=(r,t,e,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of ft(t))!pt.call(r,o)&&o!==e&&O(r,o,{get:()=>t[o],enumerable:!(a=ct(t,o))||a.enumerable});return r};var b=(r,t,e)=>(e=r!=null?ut(ht(r)):{},L(t||!r||!r.__esModule?O(e,"default",{value:r,enumerable:!0}):e,r)),dt=r=>L(O({},"__esModule",{value:!0}),r);var Rt={};gt(Rt,{PROVIDER:()=>Nt,close:()=>_t,getBook:()=>Dt,getChapter:()=>qt,getMetadata:()=>Yt});module.exports=dt(Rt);var F=b(require("dayjs"),1);var D=b(require("cheerio"),1),_=b(require("puppeteer-extra"),1),et=b(require("puppeteer-extra-plugin-stealth"),1),rt=require("tough-cookie"),nt=b(require("fetch-cookie"),1);function mt(r){return typeof r=="boolean"}function I(r){return typeof r=="number"&&!Number.isNaN(r)&&Number.isFinite(r)}function S(r){return typeof r=="string"}function w(r){return typeof r=="object"&&r!==null&&!$(r)}function $(r){return Array&&Array.isArray?Array.isArray(r):Object.prototype.toString.call(r)==="[object Array]"}function yt(r){return typeof r=="function"}function Q(r,t,e){return r-=t,e-=t,r<0&&(r=r%e+e),r>=e&&(r=r%e),r+t}function M(r){return r.replace(/[！-～]/g,function(t){return String.fromCharCode(t.charCodeAt(0)-65248)}).replace(/[^\S\r\n]/g," ")}function wt(r){let t=r.split("/"),e=t.pop(),a=t.slice(1,t.length).join("/");return new RegExp(a,e)}function q(r){let t={};for(let[e,a]of Object.entries(r))w(a)?t[e]=q(a):$(a)?t[e]=X(a):t[e]=a;return t}function U(r,t){function e(s,n){if(w(n)){for(let[i,l]of Object.entries(n))if(!a(s,l,i.split(".")))return!1;return!0}else return o(s,n,"$eq")}function a(s,n,i){let l=i.shift();return i.length>0?w(s)&&S(l)?a(s[l],n,i):!1:S(l)?o(s,n,l):!1}function o(s,n,i){if(i==="$and"){if(!$(n))throw new Error(`Invalid query type: ${typeof n}`);for(let l of n)if(!e(s,l))return!1;return!0}else{if(i==="$nand")return!o(s,n,"$and");if(i==="$or"){if(!$(n))throw new Error(`Invalid query type: ${typeof n}`);for(let l of n)if(e(s,l))return!0;return!1}else{if(i==="$nor")return!o(s,n,"$or");if(i==="$not")return!e(s,n);if(i==="$in"){if(!$(n))throw new Error(`Invalid query type: ${typeof n}`);for(let l of n)if(o(s,l,"$eq"))return!0;return!1}else{if(i==="$nin")return!o(s,n,"$in");if(i==="$gt"){if(!I(n))throw new Error(`Invalid query type: ${typeof n}`);return s>n}else if(i==="$gte"){if(!I(n))throw new Error(`Invalid query type: ${typeof n}`);return s>=n}else if(i==="$lt"){if(!I(n))throw new Error(`Invalid query type: ${typeof n}`);return s<n}else if(i==="$lte"){if(!I(n))throw new Error(`Invalid query type: ${typeof n}`);return s<=n}else if(i==="$eq")if($(s)&&$(n)){if(s.length!==n.length)return!1;for(let l in n)if(!o(s[l],n[l],"$eq"))return!1;return!0}else return w(n)?e(s,n):s===n;else{if(i==="$ne")return!o(s,n,"$eq");if(i==="$exists"){if(!mt(n))throw new Error(`Invalid query type: ${typeof n}`);return s!=null===n}else if(i==="$elemMatch"){if(!w(n))throw new Error(`Invalid query type: ${typeof n}`);if(!$(s))return!1;for(let l of s)if(!e(l,n))return!1;return!0}else if(i==="$mod"){if(!$(n))throw new Error(`Invalid query type: ${typeof n}`);let l=n[0],u=n[1];if(!I(l))throw new Error(`Invalid divisor type: ${typeof l}`);if(!I(u))throw new Error(`Invalid remainder type: ${typeof u}`);return s%l===u}else{if(i==="$size")return $(s)?e(s.length,n):w(s)?e(Object.keys(s).length,n):!1;if(i==="$function"){if(!yt(n))throw new Error(`Invalid query type: ${typeof n}`);return n(s)}else if(i==="$regex"){if(S(n))return n.charAt(0)==="/"?wt(n).test(s):new RegExp(n).test(s);if(n instanceof RegExp)return n.test(s);throw new Error(`Invalid query type: ${typeof n}`)}else if(/^\$-?[0-9]+$/.test(i)){let l=Math.floor(Q(parseInt(i.substring(1)),0,s.length));return e(s[l],n)}else return w(s)?w(n)?e(s[i],n):o(s[i],n,"$eq"):!1}}}}}}return e(r,t)}function xt(r,t){for(let e of Object.keys(t))for(let[a,o]of Object.entries(t[e])){let s=a.split("."),n=s.pop();if(!S(n))continue;let i=r;for(;w(i);){let l=s.shift();if(!l)break;i=i[l]}if(w(i)){if(e==="$set")i[n]=o;else if(e==="$unset")o&&delete i[n];else if(e==="$push")i[n].push(o);else if(e==="$pushAll"){if(Array.isArray(o))for(let l of o)i[n].push(l)}else if(e==="$pull"){for(let l=i[n].length;l>=0;l--)if(i[n][l]===o){i[n].splice(l,1);break}}else if(e==="$pullAll")Array.isArray(o)&&(i[n]=i[n].filter(function(l){for(let u of o)if(l===u)return!1;return!0}));else if(e==="$addToSet"){let l=!1;for(let u of i[n])if(u===o){l=!0;break}l||i[n].push(o)}else if(e==="$addToSetAll"&&Array.isArray(o))for(let l of o){let u=!1;for(let h of i[n])if(h===l){u=!0;break}u||i[n].push(l)}}}return r}function X(r){let t=[];for(let e=0;e<r.length;e++){let a=r[e];w(a)?r[e]=q(a):$(a)?r[e]=X(a):r[e]=a}return t}function E(r){return new Promise(function(t){return setTimeout(t,r)})}var v=[["&","&amp;"],[" ","&nbsp;"],["<","&lt;"],[">","&gt;"],['"',"&quot;"],["'","&apos;"],["\xA2","&cent;"],["\xA3","&pound;"],["\xA5","&yen;"],["\u20AC","&euro;"],["\xA9","&copy;"],["\xAE","&reg;"]],N=[["<","&lt;"],[">","&gt;"],['"',"&quot;"],["'","&apos;"]];function $t(r){return r.replace(/\r\n/g,`
`)}function At(r){return r.replace(/^</,"").replace(/([^<][!?/])?>$/,"").replace(/\s+/g," ").trim()}function Ct(r,t){for(let e=r.length-1;e>=0;e--)if(t(r[e],e,r))return e;return-1}function B(r){return encodeURIComponent(r)}function tt(r){return decodeURIComponent(r)}function bt(r){for(let t=0;t<v.length;t++)r=r.replace(new RegExp(v[t][0],"g"),v[t][1]);return r}function V(r){for(let t=v.length-1;t>=0;t--)r=r.replace(new RegExp(v[t][1],"g"),v[t][0]);return r}function It(r){for(let t=0;t<N.length;t++)r=r.replace(new RegExp(N[t][0],"g"),N[t][1]);return r}function vt(r){return r.replace(/<!--([\s\S]*?)-->/g,function(...t){return`<!-->${B(t[1])}</!-->`})}function Mt(r){return r.replace(/(<script(?:[\s\S]*?)>)([\s\S]*?)(<\/script>)/g,function(...t){return`${t[1]}${B(t[2])}${t[3]}`})}function Et(r){return r.replace(/(<style(?:[\s\S]*?)>)([\s\S]*?)(<\/style>)/g,function(...t){return`${t[1]}${B(t[2])}${t[3]}`})}function Ot(r){return r.replace(/(>)([\s\S]*?)(<)/g,function(...t){return`${t[1]}${bt(t[2])}${t[3]}`})}function St(r){function t(...e){return`=${B(e[1])} `}return r.replace(/='([^'>]*?)'/g,t).replace(/="([^">]*?)"/g,t)}function Bt(r,t){let e=t.split("="),a=e.shift();a&&(e.length===0?r[a]=!0:r[a]=tt(e.join("=")))}function jt(r){let t=At(r).split(/\s/),e={tag:t[0]||"",attributes:{},children:[],isClosing:!1,isClosed:!1,isEncoded:!1};typeof e.tag=="string"&&(e.isClosing=/^\//.test(e.tag),e.isClosed=e.isClosing,e.tag=e.tag.replace(/^\//,""),!e.isClosing&&["script","style","!--"].indexOf(e.tag)>-1&&(e.isEncoded=!0));for(let a=1;a<t.length;a++)Bt(e.attributes,t[a]);return e}function kt(r){let t="";for(let[e,a]of Object.entries(r))typeof a=="string"?t+=` ${e}="${It(a)}"`:a===!0&&(t+=` ${e}`);return t}function W(r){r=St(Ot(Et(Mt(vt($t(r))))));let t=0,e=/<[^>]*?>/g,a,o=[],s=[],n;for(;a=e.exec(r);){if(t!==a.index){let i=r.substring(t,a.index);o.push({content:V(i)})}if(n=jt(a[0]),!n.isClosing)o.push(n),s.push(n);else{let i=Ct(o,function(l){return!l.isClosed&&l.tag===n.tag});if(i>-1){let l=o[i];l.isClosed=!0,l.children=o.splice(i+1,o.length-i+1)}}t=e.lastIndex}if(t<r.length){let i=r.substring(t);o.push({content:V(i)})}for(let i of s){if(i.tag&&(i.tag.toUpperCase()==="!DOCTYPE"?i.closer="":i.tag.toLowerCase()==="?xml"?i.closer="?":i.tag==="!--"?i.closer="--":i.isClosed||(i.closer=" /"),i.isEncoded&&i.children))for(let l of i.children)l.content&&(l.content=tt(l.content));delete i.isClosed,delete i.isClosing,delete i.isEncoded}return{children:o}}function K(r,t){let e=0,a=function(o){let{tag:s,closer:n,attributes:i,content:l}=t?t(o,e):o,u="";if(e++,typeof s=="string"){if(u+=`<${s}`,typeof i=="object"&&(u+=kt(i)),typeof n!="string"&&(u+=">"),Array.isArray(o.children))for(let h of o.children)u+=a(h);typeof n!="string"?u+=`</${s}>`:u+=`${n}>`}else if(typeof l=="string")u=l;else if(Array.isArray(o.children))for(let h of o.children)u+=a(h);return u};return a(r)}function J(r){let t=function(e){let a=e.split(/([>\s])/).map(n=>n?.trim()).filter(Boolean),o=[],s;for(let n of a){if(n===">"){s=n;continue}let i=s&&s===">"?1:void 0,l={$and:[]},u=n.match(/^([a-zA-Z0-9]+)/),h=[...n.matchAll(/#([a-zA-Z0-9_-]+)/g)],d=[...n.matchAll(/\.([a-zA-Z0-9_-]+)/g)],y=[...n.matchAll(/\[([a-zA-Z0-9_-]+)([*^$]?=["']?([^"']+)["']?)?\]/g)];if(u){let c=u[1];c!=="*"?l.$and.push({tag:c}):l.$and.push({tag:{$regex:c}})}if(h.length>0)for(let c of h)l.$and.push({"attributes.id":{$regex:"(^| )("+c[1]+")( |$)"}});if(d.length>0)for(let c of d)l.$and.push({"attributes.class":{$regex:"(^| )("+c[1]+")( |$)"}});if(y.length>0)for(let c of y){let f=c[1],m=c[2]?c[2][0]:null,g=c[3],A={};m?m==="="?A["attributes."+f]=g:m==="^"?A["attributes."+f]={$regex:`^${g}`}:m==="$"?A["attributes."+f]={$regex:`${g}$`}:m==="*"&&(A["attributes."+f]={$regex:g}):A["attributes."+f]={$exists:!0},l.$and.push(A)}i?o.push({query:l,depth:i}):o.push({query:l}),s=n}return o};return r.split(",").map(e=>e.trim()).filter(Boolean).map(e=>t(e))}var zt=class Y{constructor(t){this.children=[],typeof t=="string"&&(t=W(t)),Object.assign(this,t),this.children=this.prepare(this.children)}getContent(){let t="";if(typeof this.content=="string")t+=this.content;else for(let e of this.children)t+=e.getContent();return t}setContent(t){return this.children=this.prepare([{content:t}]),this}findOne(t,e=Number.POSITIVE_INFINITY){if(!(e<1))for(let a of this.children){if(U(a,t))return a;let o=a.findOne(t,e-1);if(o)return o}}findMany(t,e=Number.POSITIVE_INFINITY){let a=[];if(e<1)return a;for(let o of this.children){U(o,t)&&a.push(o);let s=o.findMany(t,e-1);a.push(...s)}return a}querySelector(t){let e=J(t);for(let a of e){let o=[this];for(let{query:s,depth:n}of a)o=o.reduce((i,l)=>[...i,...l.findMany(s,n)],[]);if(o[0])return o[0]}}querySelectorAll(t){let e=J(t),a=[];for(let o of e){let s=[this];for(let{query:n,depth:i}of o)s=s.reduce((l,u)=>[...l,...u.findMany(n,i)],[]);a.push(...s)}return a=a.filter((o,s,n)=>n.findIndex(i=>o==i)===s),a}update(t){return xt(this,t),this.children=this.prepare(this.children),this}updateOne(t,e){let a=this.findOne(t);return a&&a.update(e),this}updateMany(t,e){let a=this.findMany(t);for(let o of a)o.update(e);return this}prepare(t){return t.map(e=>{if(e instanceof Y)return e.parent=this,e;{let a=new Y(e);return a.parent=this,a}})}replace(...t){return this.children=this.prepare(t),this}append(...t){return this.children=this.children.concat(this.prepare(t)),this}prepend(...t){return this.children.splice(0,0,...this.prepare(t)),this}insert(t,...e){return t=Math.floor(Q(t,0,this.children.length)),this.children.splice(t,0,...this.prepare(e)),this}toObject(){let t=q(this);return delete t.parent,t.children=this.children.map(e=>e.toObject()),t}toString(t){return K(this,t)}static{this.parse=W}static{this.stringify=K}};_.default.use((0,et.default)());var R=new rt.CookieJar;R.setCookieSync("over18=yes","https://novel18.syosetu.com/");R.setCookieSync("over18=off","https://syosetu.org/");var Tt=(0,nt.default)(fetch,R);async function ot(r,t,e=0){let a=0;for(;a<=e;){let o=await r.$(t);if(o)return o;await E(256),a+=256}throw new Error(`Element not found: ${t}`)}async function Pt(r,t,e=0){let a=await ot(r,t,e);return await r.evaluate(s=>s?.textContent,a)}async function it(r,t,e=0){await ot(r,t,e),await r.click(t)}async function at(r,t,e,a=0){let o=0;for(;o<=a;){let s=await Pt(r,t);if(s&&e(s))return s;await E(256),o+=256}throw new Error(`Content not found: ${t}`)}var C=class{constructor(){this.isOpened=!1,this.cacheDir=".puppeteer"}async open(){for(this.isOpened||(this.isOpened=!0,this.browser=await _.default.launch({userDataDir:this.cacheDir}));!this.browser;)await E(128)}async close(){if(this.isOpened){for(;!this.browser;)await E(128);let t=this.browser;this.browser=void 0,this.isOpened=!1,await t.close()}}async load(t,e,a){if(e||(e=[]),await this.open(),!this.browser)throw new Error("Browser not found");let o=await this.browser.newPage();try{await o.goto(t,this.pageOptions);for(let i of e){let l=setTimeout(()=>{throw new Error(`Element not found: ${i}`)},1e4);await o.waitForSelector(i,{visible:!0,timeout:0}),clearTimeout(l)}a&&await a(o);let s=await o.content(),n=D.load(s);return await o.close(),n}catch(s){throw await o.close(),s}}async fetch(t,e){let a=await Tt(t,e);if(!a.ok)throw new Error("Fetching failed");let o=await a.text();return D.load(o)}};function st(r){return typeof r=="number"?r:typeof r=="string"?isNaN(parseInt(r))?0:parseInt(r):0}function p(r){return M(r.find("br").replaceWith(`
`).end().text()).trim()}var j=class extends C{constructor(){super()}async getMetadata(t,e){let a=`https://www.alphapolis.co.jp/novel/${t}/${e}`,o=await this.fetch(a),s=o("table.detail"),n=function(A){return p(s.find("th").filter(function(){return o(this).text().trim()===A}).next())},i=/連載中/.test(p(o(".content-status.complete"))),l=p(o("h1.title")),u=p(o(".author")),h=p(o(".abstract").first()),d=n("\u521D\u56DE\u516C\u958B\u65E5\u6642").replace(/[^0-9]/g,""),y=n("\u66F4\u65B0\u65E5\u6642").replace(/[^0-9]/g,""),c=d.length===12?(0,F.default)(d,"YYYYMMDDHHmm").valueOf():0,f=y.length===12?(0,F.default)(y,"YYYYMMDDHHmm").valueOf():0,m=[];for(let A of o("div.episode a").toArray()){let Z=A.attribs.href,G=Z.split("/").pop();if(!G)throw new Error(`ChapterID not found: ${Z}`);m.push(G)}let g={onGoing:i,title:l,outline:h,author:u,chapterIds:m,createdAt:c,updatedAt:f};if(g.title===""||g.author==="")throw new Error("Metadata not found");return g}async getChapter(t,e,a){let o=`https://www.alphapolis.co.jp/novel/${t}/${e}/episode/${a}`,s=await this.load(o,null,async u=>{let h=0;for(;h<10;){h++;try{await it(u,"#TopLayer",0)}catch{}try{await at(u,"#novelBody",d=>M(d).trim()!=="",1e3);return}catch{}}throw new Error("Content not found")}),n=p(s("div.episode-title")),i=s("#novelBody").find("br").replaceWith(`
`).end().text();return{id:a,title:n,content:i}}async getBook(t,e,a){let o=await this.getMetadata(t,e),s=[],n=o.chapterIds.length;for(let l=0;l<n;l++)try{let u=o.chapterIds[l],h=await this.getChapter(t,e,u);s.push(h),a&&a(null,h,l,n)}catch(u){a&&a(u,null,l,n)}return{...o,chapters:s}}};var z=b(require("dayjs"),1);var k=class extends C{constructor(){super()}async getMetadata(t){let e=`https://syosetu.org/?mode=ss_detail&nid=${t}`,a=await this.fetch(e),o=function(g){return p(a("td").filter(function(){return a(this).text().trim()===g}).next())},s=!/短編|完結/.test(o("\u8A71\u6570")),n=o("\u30BF\u30A4\u30C8\u30EB"),i=o("\u4F5C\u8005"),l=o("\u3042\u3089\u3059\u3058"),u=parseInt(o("\u8A71\u6570").replace(/[^0-9]/g,"")),h=o("\u63B2\u8F09\u958B\u59CB").replace(/[^0-9]/g,""),d=o("\u6700\u65B0\u6295\u7A3F").replace(/[^0-9]/g,""),y=h.length===12?(0,z.default)(h,"YYYYMMDDHHmm").valueOf():0,c=d.length===12?(0,z.default)(d,"YYYYMMDDHHmm").valueOf():0,f=[];for(let g=0;g<u;g++)f.push(""+(g+1));let m={onGoing:s,title:n,outline:l,author:i,chapterIds:f,createdAt:y,updatedAt:c};if(m.title===""||m.author==="")throw new Error("Metadata not found");return m}async getChapter(t,e){let a=`https://syosetu.org/novel/${t}/${e}.html`,o=await this.fetch(a),s=p(o("#analytics_start").prev()),n=0,i=o(`#${n}`),l=[];for(;i.length!==0;)l.push(i.text()),n++,i=o(`#${n}`);return{id:e,title:s,content:l.join(`
`)}}async getBook(t,e){let a=await this.getMetadata(t),o=[],s=a.chapterIds.length;for(let i=0;i<s;i++)try{let l=a.chapterIds[i],u=await this.getChapter(t,l);o.push(u),e&&e(null,u,i,s)}catch(l){e&&e(l,null,i,s)}return{...a,chapters:o}}};var lt=b(require("dayjs"),1);var T=class extends C{constructor(){super()}async getMetadata(t){let e=`https://kakuyomu.jp/works/${t}`,a=await this.fetch(e),o=p(a("a[title]").first()),s=p(a(".CollapseTextWithKakuyomuLinks_collapseText__XSlmz")),n=p(a('a[href^="/users"]').first()),i=!1;for(let c of a(".Meta_metaItem__8eZTP").toArray()){let f=a(c).text();if(f.indexOf("\u9023\u8F09\u4E2D")>-1){i=!0;break}else if(f.indexOf("\u5B8C\u7D50\u6E08")>-1){i=!1;break}}let l=0,u=0,h=[],d=JSON.parse(a("#__NEXT_DATA__").text());for(let c of Object.values(d.props.pageProps.__APOLLO_STATE__))if(w(c)&&c.__typename==="Episode"){let f=(0,lt.default)(c.publishedAt).valueOf();l?l>f&&(l=f):l=f,u?u<f&&(u=f):u=f,h.push({id:c.id,publishedAt:f})}h.sort((c,f)=>c.publishedAt-f.publishedAt);let y={onGoing:i,title:o,outline:s,author:n,chapterIds:h.map(c=>c.id),createdAt:l,updatedAt:u};if(y.title===""||y.author==="")throw new Error("Metadata not found");return y}async getChapter(t,e){let a=`https://kakuyomu.jp/works/${t}/episodes/${e}`,o=await this.fetch(a),s=p(o("#contentMain-header .widget-episodeTitle")),n=1,i=o(`#p${n}`),l=[];for(;i.length!==0;)l.push(i.text()),n++,i=o(`#p${n}`);return{id:e,title:s,content:l.join(`
`)}}async getBook(t,e){let a=await this.getMetadata(t),o=[],s=a.chapterIds.length;for(let i=0;i<s;i++)try{let l=a.chapterIds[i],u=await this.getChapter(t,l);o.push(u),e&&e(null,u,i,s)}catch(l){e&&e(l,null,i,s)}return{...a,chapters:o}}};var H=b(require("dayjs"),1);var P=class extends C{constructor(){super()}async getMetadata(t){let e=`https://ncode.syosetu.com/novelview/infotop/ncode/${t}/`,a=await this.fetch(e),o=p(a("#noveltype"))==="\u77ED\u7DE8",s=!o&&p(a("#noveltype_not"))!=="\u5B8C\u7D50\u6E08",n=p(a("#contents_main > h1 > a")),i=p(a("#noveltable1 tbody tr:nth-child(2) td")),l=p(a("#noveltable1 tbody tr:nth-child(1) td")),u=p(a("#noveltable2 tbody tr:nth-child(1) td")).replace(/[^0-9]/g,""),h=p(a("#noveltable2 tbody tr:nth-child(2) td")).replace(/[^0-9]/g,""),d=u.length===12?(0,H.default)(u,"YYYYMMDDHHmm").valueOf():0,y=o?d:h.length===12?(0,H.default)(h,"YYYYMMDDHHmm").valueOf():0,c=st(M(a("#pre_info").text()).match(/全([0-9]+)エピソード/)?.[1]||""),f=[];if(o)f.push("");else for(let g=0;g<c;g++)f.push(""+(g+1));let m={onGoing:s,title:n,outline:l,author:i,chapterIds:f,createdAt:d,updatedAt:y};if(m.title===""||m.author==="")throw new Error("Metadata not found");return m}async getChapter(t,e){let a=e===""?`https://ncode.syosetu.com/${t}`:`https://ncode.syosetu.com/${t}/${e}`,o=await this.fetch(a),s=p(o("h1.p-novel__title")),n=1,i=o(`#L${n}`),l=[];for(;i.length!==0;)l.push(i.text()),n++,i=o(`#L${n}`);return{id:e,title:s,content:l.join(`
`)}}async getBook(t,e){let a=await this.getMetadata(t),o=[],s=a.chapterIds.length;for(let i=0;i<s;i++)try{let l=a.chapterIds[i],u=await this.getChapter(t,l);o.push(u),e&&e(null,u,i,s)}catch(l){e&&e(l,null,i,s)}return{...a,chapters:o}}};var Nt={NAROU:"narou",KAKUYOMU:"kakuyomu",ALPHAPOLIS:"alphapolis",HAMELN:"hameln"};var x={narou:new P,kakuyomu:new T,alphapolis:new j,hameln:new k};async function Yt(r,t){if(r==="narou")return await x.narou.getMetadata(t);if(r==="kakuyomu")return await x.kakuyomu.getMetadata(t);if(r==="alphapolis")return await x.alphapolis.getMetadata(t.split("/")[0],t.split("/")[1]);if(r==="hameln")return await x.hameln.getMetadata(t);throw new Error(`Invalid provider: ${r}`)}async function qt(r,t,e){if(r==="narou")return await x.narou.getChapter(t,e);if(r==="kakuyomu")return await x.kakuyomu.getChapter(t,e);if(r==="alphapolis")return await x.alphapolis.getChapter(t.split("/")[0],t.split("/")[1],e);if(r==="hameln")return await x.hameln.getChapter(t,e);throw new Error(`Invalid provider: ${r}`)}async function Dt(r,t,e){if(r==="narou")return await x.narou.getBook(t,e);if(r==="kakuyomu")return await x.kakuyomu.getBook(t,e);if(r==="alphapolis")return await x.alphapolis.getBook(t.split("/")[0],t.split("/")[1],e);if(r==="hameln")return await x.hameln.getBook(t,e);throw new Error(`Invalid provider: ${r}`)}async function _t(){for(let r of Object.values(x))await r.close()}0&&(module.exports={PROVIDER,close,getBook,getChapter,getMetadata});
